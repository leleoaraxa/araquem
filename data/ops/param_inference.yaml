version: 1
collection: araquem-core
description: >
  Regras de inferencia de parametros temporais e agregacoes aplicadas
  pelo Planner/Builder nas intents temporais (dividendos, precos). O payload do /ask
  eh imutavel; este arquivo define toda a logica declarativa.

intents:

  fiis_dividends:
    compute_on_read:
      window:
        allowed:
          - "months:3"
          - "months:6"
          - "months:12"
          - "months:24"
          - "count:1"
          - "count:3"
          - "count:6"
          - "count:12"
          - "count:24"
        default: "months:12"
      agg:
        allowed:
          - "list"
          - "avg"
          - "sum"
          - "latest"
        default: "list"
    default_agg: list
    default_window: "months:12"
    windows_allowed:
      - "months:3"
      - "months:6"
      - "months:12"
      - "months:24"
      - "count:1"
      - "count:3"
      - "count:6"
      - "count:12"
      - "count:24"

    agg_keywords:
      avg:
        include:
          - medio
          - media
          - medio do dy
          - media do dy
      sum:
        include:
          - acumulado
          - soma
          - total
      latest:
        include:
          - ultimo
          - mais recente
          - agora
          - hoje
          - recente
          - atual
        window: "count:1"
      list:
        include:
          - ultimos
          - historico
          - lista
          - listar
          - traga
          - quais

    window_keywords:
      months:
        3:
          - trimestre
          - 3 meses
          - tres meses
        6:
          - semestre
          - 6 meses
          - seis meses
        12:
          - ano
          - anual
          - 12 meses
          - doze meses
          - ultimo ano
        24:
          - 2 anos
          - dois anos
          - 24 meses
      count:
        1:
          - ultimo pagamento
          - ultimo dividendo
        3:
          - 3 ultimos
          - tres ultimos
        6:
          - 6 ultimos
          - seis ultimos
        12:
          - 12 ultimos
          - doze ultimos
        24:
          - 24 ultimos
          - vinte e quatro ultimos

    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  fiis_quota_prices:
    compute_on_read:
      window:
        allowed:
          - "months:3"
          - "months:6"
          - "months:12"
          - "months:24"
          - "count:1"
          - "count:3"
          - "count:5"
          - "count:6"
          - "count:12"
          - "count:24"
        default: "months:12"
      agg:
        allowed:
          - "list"
          - "avg"
          - "sum"
          - "latest"
        default: "list"

    default_agg: list
    default_window: "months:12"
    windows_allowed:
      - "months:3"
      - "months:6"
      - "months:12"
      - "months:24"
      - "count:1"
      - "count:3"
      - "count:5"
      - "count:6"
      - "count:12"
      - "count:24"

    agg_keywords:
      avg:
        include:
          - medio
          - media
          - preco medio
      sum:
        include:
          - acumulado
          - soma
          - total
      latest:
        include:
          - ultimo
          - mais recente
          - agora
          - hoje
          - fechamento
          - atual
          - fechou
          - fechou a quanto
          - quanto fechou
        window: "count:1"
      list:
        include:
          - ultimos
          - historico
          - lista
          - listar
          - traga
          - quais
          - historico de preco
          - historico de precos

    window_keywords:
      months:
        3:
          - trimestre
          - 3 meses
          - tres meses
          - ultimos 3 meses
        6:
          - semestre
          - 6 meses
          - seis meses
          - ultimos 6 meses
        12:
          - ano
          - anual
          - 12 meses
          - doze meses
          - ultimo ano
          - ultimos 12 meses
        24:
          - 2 anos
          - dois anos
          - 24 meses
          - ultimos 24 meses
          - ultimos 2 anos
      count:
        1:
          - ultimo pregao
          - ultima cotacao
        3:
          - 3 ultimos
          - tres ultimos
        5:
          - 5 pregoes
          - cinco pregoes
          - ultimos 5 pregoes
        6:
          - 6 ultimos
          - seis ultimos
        12:
          - 12 ultimos
          - doze ultimos
        24:
          - 24 ultimos
          - vinte e quatro ultimos

    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  fiis_overview:
    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  client_fiis_positions:
    inference: false
    required:
      - document_number
    bindings:
      document_number: context.client_id

  client_fiis_dividends_evolution:
    inference: false
    required:
      - document_number
    bindings:
      document_number: context.client_id

  client_fiis_performance_vs_benchmark:
    inference: false
    required:
      - document_number
    bindings:
      document_number: context.client_id

  client_fiis_performance_vs_benchmark_summary:
    inference: false
    required:
      - document_number
    bindings:
      document_number: context.client_id

  fiis_yield_history:
    compute_on_read:
      window:
        allowed:
          - "months:3"
          - "months:6"
          - "months:12"
          - "months:24"
          - "count:1"
          - "count:3"
          - "count:6"
          - "count:12"
          - "count:24"
        default: "months:12"
      agg:
        allowed:
          - "list"
          - "avg"
          - "sum"
          - "latest"
        default: "list"

    default_agg: list
    default_window: "months:12"
    windows_allowed:
      - "months:3"
      - "months:6"
      - "months:12"
      - "months:24"
      - "count:1"
      - "count:3"
      - "count:6"
      - "count:12"
      - "count:24"

    agg_keywords:
      avg:
        include:
          - medio
          - media
          - dy medio
          - dy media
      sum:
        include:
          - acumulado
          - soma
          - total
          - somado
      latest:
        include:
          - ultimo dy
          - dy mais recente
          - dy atual
        window: "count:1"
      list:
        include:
          - historico de dy
          - historico de dividend yield
          - ultimos dy
          - dy dos ultimos meses

    window_keywords:
      months:
        3:
          - trimestre
          - 3 meses
          - tres meses
        6:
          - semestre
          - 6 meses
          - seis meses
        12:
          - ano
          - anual
          - 12 meses
          - doze meses
          - ultimo ano
          - ultimos 12 meses
        24:
          - 2 anos
          - dois anos
          - 24 meses
      count:
        3:
          - 3 ultimos
          - tres ultimos
        6:
          - 6 ultimos
          - seis ultimos
        12:
          - 12 ultimos
          - doze ultimos
        24:
          - 24 ultimos
          - vinte e quatro ultimos

    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  fiis_financials_revenue_schedule:
    default_agg: list
    agg_keywords:
      list:
        include:
          - cronograma
          - calendario
          - agenda
          - lista
          - listar
          - traga
          - mostrar
    defaults:
      list:
        limit: 10
        order: desc
    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  fiis_financials_risk:
    default_agg: list
    agg_keywords:
      list:
        include:
          - lista
          - listar
          - traga
          - quais
          - mostrar
    defaults:
      list:
        limit: 10
        order: desc
    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  history_currency_rates:
    default_agg: list
    default_window: "months:6"
    windows_allowed:
      - "months:1"
      - "months:3"
      - "months:6"
      - "months:12"
      - "count:1"
      - "count:5"
      - "count:20"
    agg_keywords:
      latest:
        include:
          - ultimo
          - hoje
          - agora
          - fechamento
          - fechamento de ontem
        window: "count:1"
      list:
        include:
          - ultimos
          - historico
          - lista
          - listar
          - traga
          - quais

    window_keywords:
      months:
        1:
          - 1 mes
          - um mes
          - ultimo mes
        3:
          - 3 meses
          - tres meses
          - trimestre
          - ultimos 3 meses
        6:
          - semestre
          - 6 meses
          - seis meses
          - ultimos 6 meses
        12:
          - 12 meses
          - doze meses
          - ano
          - anual
          - ultimo ano
      count:
        1:
          - ultimo dia
          - ontem
          - cambio de ontem
          - cotacao de ontem
        5:
          - ultimos 5 dias
          - ultima semana
        20:
          - ultimos 20 dias
          - ultimo mes de pregao

  history_b3_indexes:
    default_agg: list
    default_window: "months:6"
    windows_allowed:
      - "months:3"
      - "months:6"
      - "months:12"
      - "months:24"
      - "count:1"
      - "count:5"
      - "count:20"
      - "count:60"

    agg_keywords:
      latest:
        include:
          - ultimo
          - hoje
          - agora
          - fechamento
          - fechamento de ontem
        window: "count:1"
      list:
        include:
          - ultimos
          - historico
          - lista
          - listar
          - traga
          - quais
          - historico do ifix

    window_keywords:
      months:
        3:
          - trimestre
          - 3 meses
          - tres meses
          - ultimos 3 meses
        6:
          - semestre
          - 6 meses
          - seis meses
          - ultimos 6 meses
        12:
          - ano
          - anual
          - 12 meses
          - doze meses
          - ultimo ano
          - ultimos 12 meses
        24:
          - 2 anos
          - dois anos
          - 24 meses
          - ultimos 24 meses
      count:
        1:
          - ultimo dia
          - ontem
          - fechamento de ontem
        5:
          - ultimos 5 dias
          - ultima semana
        20:
          - ultimos 20 dias
          - ultimos 20 pregoes
        60:
          - ultimos 60 dias

  history_market_indicators:
    default_agg: list
    default_window: "months:6"
    windows_allowed:
      - "months:1"
      - "months:3"
      - "months:6"
      - "months:12"
      - "count:1"
      - "count:5"
      - "count:20"

    agg_keywords:
      latest:
        include:
          - ultimo
          - hoje
          - agora
          - ontem
          - indicador de ontem
          - taxa de ontem
        window: "count:1"
      list:
        include:
          - ultimos
          - historico
          - lista
          - listar
          - traga
          - quais

    window_keywords:
      months:
        1:
          - 1 mes
          - um mes
          - ultimo mes
        3:
          - trimestre
          - 3 meses
          - tres meses
          - ultimos 3 meses
        6:
          - semestre
          - 6 meses
          - seis meses
          - ultimos 6 meses
        12:
          - ano
          - 12 meses
          - doze meses
          - ultimo ano
      count:
        1:
          - ultimo dia
          - ontem
        5:
          - ultimos 5 dias
          - ultima semana
        20:
          - ultimos 20 dias

  fiis_dividends_yields:
    default_agg: list
    default_window: "months:12"
    windows_allowed:
      - "months:3"
      - "months:6"
      - "months:12"
      - "months:24"
      - "count:1"
      - "count:3"
      - "count:6"
      - "count:12"
      - "count:24"

    agg_keywords:
      latest:
        include:
          - ultimo dy
          - dy atual
          - ultimo pagamento
        window: "count:1"
      list:
        include:
          - historico
          - ultimos
          - dy mensal
          - dividendos

    window_keywords:
      months:
        3:
          - trimestre
          - 3 meses
          - tres meses
        6:
          - semestre
          - 6 meses
          - seis meses
        12:
          - ano
          - 12 meses
          - doze meses
          - ultimo ano
        24:
          - 2 anos
          - dois anos
          - 24 meses
      count:
        1:
          - ultimo mes
        3:
          - 3 ultimos
          - tres ultimos
        6:
          - 6 ultimos
          - seis ultimos
        12:
          - 12 ultimos
          - doze ultimos
        24:
          - 24 ultimos
          - vinte e quatro ultimos

    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  client_fiis_enriched_portfolio:
    inference: false
    required:
      - document_number
    bindings:
      document_number: context.client_id

  macro_consolidada:
    default_agg: list
    default_window: "months:6"
    windows_allowed:
      - "months:1"
      - "months:3"
      - "months:6"
      - "months:12"
      - "count:5"
      - "count:10"
      - "count:20"
      - "count:30"
      - "count:60"

    agg_keywords:
      latest:
        include:
          - ultimo
          - hoje
          - agora
        window: "count:1"
      list:
        include:
          - historico
          - serie
          - lista
          - ultimos

    window_keywords:
      months:
        1:
          - ultimo mes
        3:
          - trimestre
          - 3 meses
          - tres meses
        6:
          - semestre
          - 6 meses
          - seis meses
        12:
          - ano
          - 12 meses
          - doze meses
      count:
        5:
          - 5 dias
          - cinco dias
        10:
          - 10 dias
          - dez dias
        20:
          - 20 dias
          - vinte dias
        30:
          - 30 dias
          - trinta dias
        60:
          - 60 dias
          - sessenta dias

  fiis_registrations:
    agg_keywords: {}
    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  fiis_news:
    agg_keywords: {}
    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  fiis_real_estate:
    agg_keywords: {}
    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  fiis_rankings:
    agg_keywords: {}
    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference

  fiis_legal_proceedings:
    default_agg: list
    defaults:
      list:
        limit: 10
        order: desc
    params:
      ticker:
        source:
          - text
          - context
        allow_multi_ticker: true
        context_key: last_reference
