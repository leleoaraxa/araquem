# Este arquivo define semântica de intenção (não capacidades). Capacidade = entidade YAML.
version: 1
collection: araquem-core
description: >
  Regras de inferência de parâmetros temporais e agregações
  aplicadas pelo Planner/Builder nas intents temporais (dividendos, preços).
  O payload do /ask é imutável; este arquivo define toda a lógica declarativa.

intents:
  fiis_dividendos:
    default_agg: list
    default_window: "count:6"
    agg_keywords:
      latest:
        include: [ultimo, última, mais recente, agora, hoje, recente, atual]
        window: "count:1"
      list:
        include: [ultimos, últimas, historico, histórico, lista, listar, traga, quais]
    window_keywords:
      months:
        3: [trimestre, 3 meses, tres meses]
        6: [semestre, 6 meses, seis meses]
        12: [ano, anual, 12 meses, doze meses, ultimo ano, últimos 12 meses]
        24: [2 anos, dois anos, 24 meses]
      count:
        3: [3 ultimos, tres ultimos, tres últimas]
        6: [6 ultimos, seis ultimos]
        12: [12 ultimos, doze ultimos]
        24: [24 ultimos, vinte e quatro ultimos]

  fiis_precos:
    default_agg: latest
    default_window: "count:1"
    agg_keywords:
      latest:
        include: [ultimo, última, mais recente, agora, hoje, fechamento, atual]
        window: "count:1"
      list:
        include: [ultimos, últimas, historico, histórico, lista, listar, traga, quais]
    window_keywords:
      months:
        3: [trimestre, 3 meses, tres meses]
        6: [semestre, 6 meses, seis meses]
        12: [ano, anual, 12 meses, doze meses, ultimo ano]
        24: [2 anos, dois anos, 24 meses]
      count:
        3: [3 ultimos, tres ultimos, tres últimas]
        6: [6 ultimos, seis ultimos]
        12: [12 ultimos, doze ultimos]
        24: [24 ultimos, vinte e quatro ultimos]

  client_fiis_positions:
    inference: false           # não inferir por texto
    required: [document_number]
    bindings:
      document_number: context.client_id   # mapear do contexto seguro -> parâmetro SQL

  fiis_financials_revenue_schedule:
    default_agg: list
    default_window: "months:12"
    agg_keywords:
      list:
        include:
          - cronograma
          - calendário
          - agenda
          - lista
          - listar
          - traga
          - mostrar
    window_keywords:
      months:
        6:
          - ultimo semestre
          - último semestre
          - 6 meses
          - seis meses
        12:
          - ultimo ano
          - último ano
          - 12 meses
          - doze meses
        24:
          - 2 anos
          - dois anos
          - 24 meses
    defaults:
      list:
        limit: 50    # ou outro limite que faça sentido
        order: asc   # cronograma tende a ser melhor crescente (mais antigo -> mais recente)
    windows_allowed:
      - "months:6"
      - "months:12"
      - "months:24"
