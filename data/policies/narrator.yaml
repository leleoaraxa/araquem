terms:
- name: narrator
  kind: policy
  scope: narrator
  version: 1

narrator:
  model: sirios-narrator:latest
  llm_enabled: true
  shadow: false

  # Buckets:
  # - A/B/C → SQL-only (llm_enabled=false via entities)
  # - D     → conceitual/chitchat (usa default.llm_enabled=true quando não há entidade)
  buckets:
    A:
      llm_enabled: false
    B:
      llm_enabled: false
    C:
      llm_enabled: false
    D:
      llm_enabled: true
      mode: global_post_sql
      max_tokens: 512
      temperature: 0.1
      entities:
        - macro_consolidada
  default:
    llm_enabled: true
    shadow: false
    model: sirios-narrator:latest
    style: executivo

    # Limites de uso do LLM
    max_llm_rows: 999
    max_prompt_tokens: 2000
    max_output_tokens: 400

    # RAG / contexto
    use_rag_in_prompt: false
    use_conversation_context: false
    rag_snippet_max_chars: 320
    prefer_concept_when_no_ticker: true
    rag_fallback_when_no_rows: false
    concept_with_data_when_rag: false

  entities:
    # ──────────────────
    # Núcleo de RISCO
    # ──────────────────
    # Receita indexada (IPCA/CDI etc.) – por enquanto sem LLM
    fiis_financials_revenue_schedule:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    # ──────────────────
    # Série histórica de mercado / macro
    # ──────────────────
    history_market_indicators:
      llm_enabled: false
      shadow: false
      max_llm_rows: 5
      rag_snippet_max_chars: 260
      use_rag_in_prompt: true
      use_conversation_context: false
      prefer_concept_when_no_ticker: true
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: true
      strict_mode: false

    history_b3_indexes:
      llm_enabled: false
      shadow: false
      max_llm_rows: 5
      rag_snippet_max_chars: 260
      use_rag_in_prompt: true
      use_conversation_context: false
      prefer_concept_when_no_ticker: true
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: true
      strict_mode: false

    history_currency_rates:
      llm_enabled: false
      shadow: false
      max_llm_rows: 5
      rag_snippet_max_chars: 260
      use_rag_in_prompt: true
      use_conversation_context: false
      prefer_concept_when_no_ticker: true
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: true
      strict_mode: false

    # ──────────────────
    # Overview / yield / carteira
    # ──────────────────
    fii_overview:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_yield_history:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    dividendos_yield:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    carteira_enriquecida:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    macro_consolidada:
      llm_enabled: true
      shadow: false
      max_llm_rows: 50
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false
      instruction: |
        Atue como Narrator de cenário macro consolidado para FIIs, usando as linhas da
        entidade como âncora factual para juros, inflação, câmbio e índices locais.
        Entregue um snapshot interpretativo do ambiente macro (Selic/CDI, IPCA e
        dólar), explicando como a dinâmica de taxas e inflação tende a afetar FIIs de
        tijolo e de papel. Relacione Selic, CDI e IPCA ao desempenho típico dos FIIs e
        destaque se o contexto está mais favorável ou desfavorável para quem busca
        renda com FIIs.

    # ──────────────────
    # Cadastro / preços / processos / rankings / notícias / riscos
    # ──────────────────
    fiis_financials_risk:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_noticias:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_cadastro:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_dividendos:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_financials_snapshot:
      llm_enabled: false
      shadow: false
      max_llm_rows: 50
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_imoveis:
      llm_enabled: false
      shadow: false
      max_llm_rows: 50
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_precos:
      llm_enabled: false
      shadow: false
      max_llm_rows: 20
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_processos:
      llm_enabled: true
      shadow: false
      max_llm_rows: 50
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    fiis_rankings:
      llm_enabled: false
      shadow: false
      max_llm_rows: 50
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    # ──────────────────
    # Entidades do cliente (posições / desempenho / dividendos evol.)
    # ──────────────────
    client_fiis_positions:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    client_fiis_dividends_evolution:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false

    client_fiis_performance_vs_benchmark:
      llm_enabled: false
      shadow: false
      max_llm_rows: 0
      use_rag_in_prompt: false
      use_conversation_context: false
      rag_fallback_when_no_rows: false
      concept_with_data_when_rag: false
      strict_mode: false
