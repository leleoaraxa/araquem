id: fiis_quota_prices
result_key: precos_fii
sql_view: fiis_quota_prices
private: false
description: Consulta de preço/cotação/variação das cotas de FIIs (histórico ou atual).

options:
  supports_multi_ticker: true
  multi_ticker_mode: batch

identifiers:
- name: ticker
  description: Ticker do FII normalizado (AAAA11)
default_date_field: traded_at
columns:
- name: ticker
  alias: Código FII
  description: Código do fundo na B3 (AAAA11).
- name: traded_at
  alias: Data de negociação
  description: Data do pregão (yyyy-mm-dd).
- name: close_price
  alias: Preço de fechamento
  description: Preço de fechamento do dia.
- name: adj_close_price
  alias: Fechamento ajustado
  description: Preço de fechamento ajustado por eventos.
- name: open_price
  alias: Preço de abertura
  description: Preço de abertura do dia.
- name: max_price
  alias: Máxima do dia
  description: Maior preço negociado no dia.
- name: min_price
  alias: Mínima do dia
  description: Menor preço negociado no dia.
- name: daily_variation_pct
  alias: Variação diária (%)
  description: Variação percentual do dia vs. anterior.
- name: created_at
  alias: Criado em
  description: Data de criação do registro.
- name: updated_at
  alias: Atualizado em
  description: Data da última atualização do registro.
presentation:
  kind: table
  fields:
    key: traded_at
    value: close_price
  empty_message: Sem preços para exibir.

ask:
  intents:
    - fiis_quota_prices
  requires_identifiers:
    - tickers
  keywords:
    - abertura
    - aberturas
    - abrir
    - cotacao
    - cotacoes
    - cotacaoo
    - cotaco
    - cotacaos
    - diaria
    - diarias
    - fechar
    - fechamento do dia
    - fechamento
    - fechamentos
    - maxima
    - maximas
    - minima
    - minimas
    - pregao
    - pregoes
    - preco
    - precos
    - precoo
    - prco
    - variacao
    - variacao diaria
    - variacoes
    - variacoes diarias
    - oscilacao diaria
    - hoje
    - ontem
    - d-1

  anti_tokens:
    - abertura de conta
    - administradores
    - administrador
    - alavancagem
    - analise
    - area
    - beta
    - betaa
    - bucket
    - cadastro
    - carteira
    - carteira consolidada
    - carteira do cliente
    - cliente
    - cnpj
    - contrato
    - contratos
    - noticia
    - noticias
    - materia
    - ultimas
    - dy
    - d y
    - d.y
    - dividend
    - dividendo
    - dividendos
    - dividendoos
    - dvdndos
    - provento
    - proventos
    - risco
    - riscos
    - sharpe
    - sortino
    - volatilidade
    - vacancia
    - vacancias
    - metragem
    - imovel
    - imoveis
    - receita
    - receita futura
    - contratos futuros
    - indexador
    - bucket macro
    - macro
    - curva de juros
    - juros futuros
    - cenario macro
    - selic
    - cdi
    - ipca
    - inflacao
    - dolar
    - euro
    - snapshot
    - overview
    - cadastro do fii
    - risco do fii
    - ranking
    - mandato
    - setor
    - segmentos
    - segmento
    - noticia macro
    - minha carteira
    - minha posicao
    - minhas posicoes
    - custodia
    - yield
    - variacao de dy
    - precos alvo

  phrase_includes:
    - "cotacao do"
    - "preco do"
    - "preco historico do"
    - "qual a cotacao do"
    - "qual o preco do"
    - "quanto esta o"
    - "quanto esta a"
    - "quanto esta custando o"
    - "quanto ta o"
    - "variacao diaria do"
    - "variacao diaria do nos ultimos"
    - "variacao diaria do ticker"
    - "variacao do ticker nos ultimos"
    - "cotacao historica do"
    - "fechou a quanto"
    - "quanto fechou"
    - "preco de fechamento de ontem do"
    - "preco de fechamento de hoje do"
    - "preco de hoje do"
    - "preco de ontem do"
    - "maxima do"
    - "minima do"
    - "maxima e minima do"
    - "maxima e minima do nos ultimos"
    - "quanto variou hoje o"
    - "quanto variou ontem o"

  metrics_synonyms:
    close_price:
      - fechamento
      - preco de fechamento
      - cotacao de fechamento
      - close
    daily_variation_pct:
      - variacao
      - variacao no dia
      - alta
      - queda
      - oscilacao
      - "% no dia"
    traded_at:
      - data
      - pregao
      - ultimo pregao
    open_price:
      - abertura
      - preco de abertura
    max_price:
      - maxima
      - preco maximo
    min_price:
      - minima
      - preco minimo

  synonyms:
    ticker:
      - ativo
      - fii
      - fundo
      - papel
    traded_at:
      - negociacao
      - pregao
    close_price:
      - fechamento
      - fechar
      - preco de fechamento
    adj_close_price:
      - ajustado
      - fechamento ajustado
    open_price:
      - abertura
      - abrir
      - preco de abertura
    max_price:
      - maxima
      - maxima do dia
    min_price:
      - minima
      - minima do dia
    daily_variation_pct:
      - variacao
      - variacao diaria
      - oscilacao
      - alta do dia
      - queda do dia

  weights:
    identifiers: 2.0
    keywords: 1.0
    synonyms: 0.5

sample_questions:
  - variacao diaria do XPML11 nos ultimos 5 pregoes
  - quanto esta o HGLG11 hoje
  - maxima e minima do VISC11 no ultimo pregao
  - quanto fechou o KNRI11 ontem

order_by_whitelist:
- traded_at desc

aggregations:
  enabled: true
  defaults:
    inference: true
    list:
      limit: 10
      order: desc
    avg:
      window: "months:6"
    sum:
      window: "months:12"
  windows_allowed:
    - "months:3"
    - "months:6"
    - "months:12"
    - "months:24"
    - "count:1"
    - "count:3"
    - "count:5"
    - "count:6"
    - "count:12"
    - "count:24"

responses:
  default:
    kind: table
    template: responses/table.md.j2
