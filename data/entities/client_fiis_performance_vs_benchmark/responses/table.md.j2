{% set rows = rows if rows is defined else [] %}

{% if rows and rows|length > 0 -%}
  {% set latest = rows[0] %}
  **Performance da carteira vs {{ latest.benchmark_code or 'benchmark' }}**

  - Última referência: **{{ latest.date_reference if latest.date_reference is not none else '-' }}**
  - Retorno da carteira: **{{ latest.portfolio_return_pct if latest.portfolio_return_pct is not none else '-' }}**
  - Retorno do benchmark: **{{ latest.benchmark_return_pct if latest.benchmark_return_pct is not none else '-' }}**

  {% set janela = rows[:12] %}
  | Data | Retorno carteira | Retorno benchmark | Valor da carteira | Valor do benchmark |
  | --- | ---: | ---: | ---: | ---: |
  {%- for r in janela %}
  | {{ r.date_reference if r.date_reference is not none else '-' }} | {{ r.portfolio_return_pct if r.portfolio_return_pct is not none else '-' }} | {{ r.benchmark_return_pct if r.benchmark_return_pct is not none else '-' }} | {{ r.portfolio_amount if r.portfolio_amount is not none else '-' }} | {{ r.benchmark_value if r.benchmark_value is not none else '-' }} |
  {%- endfor %}
{%- else -%}
  {{ empty_message or "Sem histórico de performance para exibir." }}
{%- endif %}
