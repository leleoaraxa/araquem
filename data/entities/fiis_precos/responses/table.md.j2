{% set rows = rows if rows is defined else [] %}
{% if rows and rows|length > 0 -%}
  {%- if rows|length == 1 -%}
    {%- set r = rows[0] -%}
    ### Preços recentes do {{ r.ticker or '-' }}

    - Último pregão: **{{ r.traded_at | date_br if r.traded_at else '-' }}**
    - Preço de fechamento: **{{ r.close_price | currency_br if r.close_price is not none else '-' }}**
    - Variação no dia: **{{ r.daily_variation_pct | percent_raw_br if r.daily_variation_pct is not none else '-' }}**
  {%- endif %}

  | Data | Código | Preço de fechamento (R$) | Preço ajustado (R$) | Abertura (R$) | Máxima (R$) | Mínima (R$) | Variação diária (%) | Criado em | Atualizado em |
  | --- | --- | ---: | ---: | ---: | ---: | ---: | ---: | --- | --- |
  {%- for r in rows %}
    | {{ r.traded_at | date_br if r.traded_at else '-' }} | {{ r.ticker or '-' }} | {{ r.close_price | currency_br if r.close_price is not none else '-' }} | {{ r.adj_close_price | currency_br if r.adj_close_price is not none else '-' }} | {{ r.open_price | currency_br if r.open_price is not none else '-' }} | {{ r.max_price | currency_br if r.max_price is not none else '-' }} | {{ r.min_price | currency_br if r.min_price is not none else '-' }} | {{ r.daily_variation_pct | percent_raw_br if r.daily_variation_pct is not none else '-' }} | {{ r.created_at | datetime_br if r.created_at else '-' }} | {{ r.updated_at | datetime_br if r.updated_at else '-' }} |
  {%- endfor %}
{%- else -%}
  {{ empty_message or "Nenhum registro encontrado." }}
{%- endif %}
