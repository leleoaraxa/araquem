{
  "executor_payload": {
    "question": "pontos do ifil de ontem",
    "facts": {
      "result_key": "history_b3_indexes",
      "rows": [
        {
          "index_date": "2025-11-17 00:00:00",
          "ibov_points_count": 157739.0,
          "ibov_var_pct": "37,00%",
          "ifix_points_count": 3617.0,
          "ifix_var_pct": "71,00%",
          "ifil_points_count": 1597.0,
          "ifil_var_pct": "72,00%",
          "created_at": "2025-11-16 00:00:00",
          "updated_at": "2025-11-16 00:00:00"
        },
        {
          "index_date": "2025-11-14 00:00:00",
          "ibov_points_count": 157739.0,
          "ibov_var_pct": "37,00%",
          "ifix_points_count": 3617.0,
          "ifix_var_pct": "71,00%",
          "ifil_points_count": 1597.0,
          "ifil_var_pct": "72,00%",
          "created_at": "2025-11-15 00:00:00",
          "updated_at": "2025-11-15 00:00:00"
        },
        {
          "index_date": "2025-11-13 00:00:00",
          "ibov_points_count": 157162.0,
          "ibov_var_pct": "-30,00%",
          "ifix_points_count": 3591.0,
          "ifix_var_pct": "-17,00%",
          "ifil_points_count": 1586.0,
          "ifil_var_pct": "-18,00%",
          "created_at": "2025-11-14 00:00:00",
          "updated_at": "2025-11-14 00:00:00"
        },
        {
          "index_date": "2025-11-12 00:00:00",
          "ibov_points_count": 157633.0,
          "ibov_var_pct": "-7,00%",
          "ifix_points_count": 3597.0,
          "ifix_var_pct": "12,00%",
          "ifil_points_count": 1589.0,
          "ifil_var_pct": "13,00%",
          "created_at": "2025-11-13 00:00:00",
          "updated_at": "2025-11-13 00:00:00"
        },
        {
          "index_date": "2025-11-11 00:00:00",
          "ibov_points_count": 157749.0,
          "ibov_var_pct": "1,60%",
          "ifix_points_count": 3593.0,
          "ifix_var_pct": "-1,00%",
          "ifil_points_count": 1587.0,
          "ifil_var_pct": "-2,00%",
          "created_at": "2025-11-12 00:00:00",
          "updated_at": "2025-11-12 00:00:00"
        },
        {
          "index_date": "2025-11-10 00:00:00",
          "ibov_points_count": 154064.0,
          "ibov_var_pct": "47,00%",
          "ifix_points_count": 3597.0,
          "ifix_var_pct": "11,00%",
          "ifil_points_count": 1587.0,
          "ifil_var_pct": "-9,00%",
          "created_at": "2025-11-09 00:00:00",
          "updated_at": "2025-11-09 00:00:00"
        },
        {
          "index_date": "2025-11-07 00:00:00",
          "ibov_points_count": 154064.0,
          "ibov_var_pct": "47,00%",
          "ifix_points_count": 3597.0,
          "ifix_var_pct": "11,00%",
          "ifil_points_count": 1588.0,
          "ifil_var_pct": "12,00%",
          "created_at": "2025-11-08 00:00:00",
          "updated_at": "2025-11-08 00:00:00"
        },
        {
          "index_date": "2025-11-06 00:00:00",
          "ibov_points_count": 153339.0,
          "ibov_var_pct": "3,00%",
          "ifix_points_count": 3593.0,
          "ifix_var_pct": "5,00%",
          "ifil_points_count": 1586.0,
          "ifil_var_pct": "6,00%",
          "created_at": "2025-11-07 00:00:00",
          "updated_at": "2025-11-07 00:00:00"
        },
        {
          "index_date": "2025-11-05 00:00:00",
          "ibov_points_count": 153294.0,
          "ibov_var_pct": "1,72%",
          "ifix_points_count": 3591.0,
          "ifix_var_pct": "3,00%",
          "ifil_points_count": 1585.0,
          "ifil_var_pct": "2,00%",
          "created_at": "2025-11-06 00:00:00",
          "updated_at": "2025-11-06 00:00:00"
        },
        {
          "index_date": "2025-11-04 00:00:00",
          "ibov_points_count": 150704.0,
          "ibov_var_pct": "17,00%",
          "ifix_points_count": 3590.0,
          "ifix_var_pct": "-5,00%",
          "ifil_points_count": 1585.0,
          "ifil_var_pct": "-7,00%",
          "created_at": "2025-11-05 00:00:00",
          "updated_at": "2025-11-05 00:00:00"
        }
      ],
      "primary": {
        "index_date": "2025-11-17 00:00:00",
        "ibov_points_count": 157739.0,
        "ibov_var_pct": "37,00%",
        "ifix_points_count": 3617.0,
        "ifix_var_pct": "71,00%",
        "ifil_points_count": 1597.0,
        "ifil_var_pct": "72,00%",
        "created_at": "2025-11-16 00:00:00",
        "updated_at": "2025-11-16 00:00:00"
      },
      "aggregates": {
        "agg": null,
        "window": null,
        "order": "desc"
      },
      "identifiers": {},
      "ticker": null,
      "fund": null
    },
    "meta": {
      "intent": "history_b3_indexes",
      "entity": "history_b3_indexes",
      "explain": {
        "signals": {
          "token_scores": [
            {
              "token": "ifil",
              "weight": 1.1,
              "hits": 1,
              "intent": "fiis_cadastro"
            },
            {
              "token": "ontem",
              "weight": 1.1,
              "hits": 1,
              "intent": "fiis_precos"
            },
            {
              "token": "ifil",
              "weight": -1.1,
              "hits": 1,
              "intent": "fiis_precos"
            },
            {
              "token": "ifil",
              "weight": 1.1,
              "hits": 1,
              "intent": "fiis_rankings"
            },
            {
              "token": "pontos",
              "weight": -1.1,
              "hits": 1,
              "intent": "fiis_rankings"
            },
            {
              "token": "ontem",
              "weight": -1.1,
              "hits": 1,
              "intent": "fiis_rankings"
            },
            {
              "token": "ifil",
              "weight": 1.1,
              "hits": 1,
              "intent": "history_b3_indexes"
            },
            {
              "token": "pontos",
              "weight": 1.1,
              "hits": 1,
              "intent": "history_b3_indexes"
            },
            {
              "token": "ontem",
              "weight": 1.1,
              "hits": 1,
              "intent": "history_b3_indexes"
            },
            {
              "token": "ontem",
              "weight": 1.1,
              "hits": 1,
              "intent": "history_currency_rates"
            },
            {
              "token": "ifil",
              "weight": -1.1,
              "hits": 1,
              "intent": "history_currency_rates"
            },
            {
              "token": "ontem",
              "weight": 1.1,
              "hits": 1,
              "intent": "history_market_indicators"
            },
            {
              "token": "ifil",
              "weight": -1.1,
              "hits": 1,
              "intent": "history_market_indicators"
            }
          ],
          "phrase_scores": [
            {
              "phrase": "pontos do ifil",
              "weight": 3.3,
              "hits": 1,
              "intent": "history_b3_indexes"
            }
          ],
          "anti_hits": [],
          "normalizations": [
            {
              "step": "lower",
              "applied": true
            },
            {
              "step": "strip_accents",
              "applied": true
            },
            {
              "step": "strip_punct",
              "applied": true
            }
          ],
          "weights_summary": {
            "token_sum": 3.3000000000000003,
            "phrase_sum": 3.3,
            "anti_sum": 0.0,
            "total": 6.6
          }
        },
        "decision_path": [
          {
            "stage": "tokenize",
            "type": "normalization",
            "value": "pontos do ifil de ontem",
            "result": [
              "pontos",
              "do",
              "ifil",
              "de",
              "ontem"
            ]
          },
          {
            "stage": "rank",
            "type": "intent_scoring",
            "intent": "history_b3_indexes",
            "score": 6.6
          },
          {
            "stage": "route",
            "type": "entity_select",
            "entity": "history_b3_indexes",
            "score_after": 6.6
          },
          {
            "stage": "rag",
            "type": "entity_hints",
            "k": 5,
            "min_score": 0.25,
            "weight": 0.35,
            "hints_keys": []
          }
        ],
        "scoring": {
          "intent": [
            {
              "name": "history_b3_indexes",
              "score": 6.6,
              "winner": true
            }
          ],
          "entity": [
            {
              "name": "history_b3_indexes",
              "score": 6.6,
              "winner": true
            }
          ],
          "intent_top2_gap_base": 5.5,
          "intent_top2_gap_final": 5.5,
          "final_combined": [
            {
              "intent": "history_b3_indexes",
              "score": 6.6
            },
            {
              "intent": "fiis_cadastro",
              "score": 1.1
            },
            {
              "intent": "client_fiis_positions",
              "score": 0.0
            },
            {
              "intent": "fiis_precos",
              "score": 0.0
            },
            {
              "intent": "fiis_dividendos",
              "score": 0.0
            },
            {
              "intent": "fiis_financials_snapshot",
              "score": 0.0
            },
            {
              "intent": "fiis_financials_revenue_schedule",
              "score": 0.0
            },
            {
              "intent": "fiis_financials_risk",
              "score": 0.0
            },
            {
              "intent": "fiis_imoveis",
              "score": 0.0
            },
            {
              "intent": "fiis_noticias",
              "score": 0.0
            },
            {
              "intent": "fiis_processos",
              "score": 0.0
            },
            {
              "intent": "history_currency_rates",
              "score": 0.0
            },
            {
              "intent": "history_market_indicators",
              "score": 0.0
            },
            {
              "intent": "fiis_rankings",
              "score": -1.1
            }
          ],
          "rag_hint": [],
          "rag_signal": [
            {
              "intent": "client_fiis_positions",
              "entity": "client_fiis_positions",
              "score": 0.0
            },
            {
              "intent": "fiis_cadastro",
              "entity": "fiis_cadastro",
              "score": 0.0
            },
            {
              "intent": "fiis_precos",
              "entity": "fiis_precos",
              "score": 0.0
            },
            {
              "intent": "fiis_dividendos",
              "entity": "fiis_dividendos",
              "score": 0.0
            },
            {
              "intent": "fiis_financials_snapshot",
              "entity": "fiis_financials_snapshot",
              "score": 0.0
            },
            {
              "intent": "fiis_financials_revenue_schedule",
              "entity": "fiis_financials_revenue_schedule",
              "score": 0.0
            },
            {
              "intent": "fiis_financials_risk",
              "entity": "fiis_financials_risk",
              "score": 0.0
            },
            {
              "intent": "fiis_imoveis",
              "entity": "fiis_imoveis",
              "score": 0.0
            },
            {
              "intent": "fiis_noticias",
              "entity": "fiis_noticias",
              "score": 0.0
            },
            {
              "intent": "fiis_processos",
              "entity": "fiis_processos",
              "score": 0.0
            },
            {
              "intent": "fiis_rankings",
              "entity": "fiis_rankings",
              "score": 0.0
            },
            {
              "intent": "history_b3_indexes",
              "entity": "history_b3_indexes",
              "score": 0.0
            },
            {
              "intent": "history_currency_rates",
              "entity": "history_currency_rates",
              "score": 0.0
            },
            {
              "intent": "history_market_indicators",
              "entity": "history_market_indicators",
              "score": 0.0
            }
          ],
          "combined": {
            "intent": [
              {
                "name": "history_b3_indexes",
                "base": 6.6,
                "rag": 0.0,
                "combined": 6.6,
                "winner": true
              },
              {
                "name": "fiis_cadastro",
                "base": 1.1,
                "rag": 0.0,
                "combined": 1.1,
                "winner": false
              },
              {
                "name": "client_fiis_positions",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_precos",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_dividendos",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_financials_snapshot",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_financials_revenue_schedule",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_financials_risk",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_imoveis",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_noticias",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_processos",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "history_currency_rates",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "history_market_indicators",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_rankings",
                "base": -1.1,
                "rag": 0.0,
                "combined": -1.1,
                "winner": false
              }
            ],
            "entity": [
              {
                "name": "history_b3_indexes",
                "base": 6.6,
                "rag": 0.0,
                "combined": 6.6,
                "winner": true
              },
              {
                "name": "fiis_cadastro",
                "base": 1.1,
                "rag": 0.0,
                "combined": 1.1,
                "winner": false
              },
              {
                "name": "client_fiis_positions",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_precos",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_dividendos",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_financials_snapshot",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_financials_revenue_schedule",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_financials_risk",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_imoveis",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_noticias",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_processos",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "history_currency_rates",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "history_market_indicators",
                "base": 0.0,
                "rag": 0.0,
                "combined": 0.0,
                "winner": false
              },
              {
                "name": "fiis_rankings",
                "base": -1.1,
                "rag": 0.0,
                "combined": -1.1,
                "winner": false
              }
            ],
            "weight": 0.0,
            "notes": "blend=base*(1-w)+rag*w"
          },
          "thresholds_applied": {
            "min_score": 1.0,
            "min_gap": 0.5,
            "gap": 5.5,
            "accepted": true,
            "source": "final"
          }
        },
        "rag": {
          "enabled": true,
          "index_path": "data/embeddings/store/embeddings.jsonl",
          "k": 5,
          "min_score": 0.25,
          "weight": 0.35,
          "entity_hints": {},
          "error": null,
          "used": false,
          "re_rank": {
            "enabled": true,
            "mode": "blend",
            "weight": 0.15
          }
        },
        "fusion": {
          "enabled": true,
          "used": false,
          "weight": 0.0,
          "mode": "blend",
          "affected_entities": [],
          "error": null
        }
      }
    }
  }
}
